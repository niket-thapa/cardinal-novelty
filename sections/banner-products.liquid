{% comment %}
  Banner with Products Section
  Displays a banner with heading, description, button and up to 3 products
{% endcomment %}

{{ 'component-card.css' | asset_url | stylesheet_tag }}
{{ 'component-price.css' | asset_url | stylesheet_tag }}
{{ 'banner-products.css' | asset_url | stylesheet_tag }}

{%- unless section.settings.quick_add == 'none' -%}
  {{ 'quick-add.css' | asset_url | stylesheet_tag }}
  <script src="{{ 'product-form.js' | asset_url }}" defer="defer"></script>
{%- endunless -%}

{%- if section.settings.quick_add == 'standard' -%}
  <script src="{{ 'quick-add.js' | asset_url }}" defer="defer"></script>
{%- endif -%}

{%- if section.settings.quick_add == 'bulk' -%}
  <script src="{{ 'quick-add-bulk.js' | asset_url }}" defer="defer"></script>
  <script src="{{ 'quantity-popover.js' | asset_url }}" defer="defer"></script>
  <script src="{{ 'price-per-item.js' | asset_url }}" defer="defer"></script>
  <script src="{{ 'quick-order-list.js' | asset_url }}" defer="defer"></script>
{%- endif -%}

<div class="banner-products">
  <div class="banner-products__container page-width">
    <div class="banner-products__layout">
      <!-- Banner Section -->
      <div class="banner-products__banner{% if section.settings.banner_image != blank %} banner-products__banner--with-image{% endif %}"{% if section.settings.banner_image != blank %} style="background-image: url('{{ section.settings.banner_image | image_url: width: 1200 }}');"{% endif %}>
        <div class="banner-products__banner-content">
          {% if section.settings.banner_heading != blank %}
            <h2 class="banner-products__banner-heading">{{ section.settings.banner_heading }}</h2>
          {% endif %}
          
          {% if section.settings.banner_description != blank %}
            <div class="banner-products__banner-description">
              {{ section.settings.banner_description }}
            </div>
          {% endif %}
          
          {% if section.settings.banner_button_text != blank and section.settings.banner_button_link != blank %}
            <a 
              href="{{ section.settings.banner_button_link }}"
              class="button button--secondary"
            >
              {{ section.settings.banner_button_text }}
            </a>
          {% endif %}
        </div>
      </div>
      
      <!-- Products Section -->
      <div class="banner-products__products">
        <div class="banner-products__products-grid product-grid contains-card contains-card--product{% if settings.card_style == 'standard' %} contains-card--standard{% endif %} grid--1-col-tablet-down">
          {% for i in (1..3) %}
            {% assign product_setting = 'product_' | append: i %}
            {% assign product = section.settings[product_setting] %}
            
            {% if product != blank %}
              <div class="custom_grid__item">
                {% render 'card-product',
                  card_product: product,
                  media_aspect_ratio: 'square',
                  image_shape: 'default',
                  lazy_load: true,
                  show_secondary_image: false,
                  show_vendor: false,
                  show_rating: false,
                  show_short_description: section.settings.show_short_description,
                  show_price: section.settings.show_price,
                  skip_styles: true,
                  section_id: section.id,
                  quick_add: section.settings.quick_add
                %}
              </div>
            {% endif %}
          {% endfor %}
        </div>
      </div>
    </div>
  </div>
</div>

{% schema %}
{
  "name": "Banner with Products",
  "tag": "section",
  "class": "section",
  "settings": [
    {
      "type": "header",
      "content": "Banner Settings"
    },
    {
      "type": "image_picker",
      "id": "banner_image",
      "label": "Banner Background Image"
    },
    {
      "type": "text",
      "id": "banner_heading",
      "label": "Banner Heading",
      "default": "Featured Collection"
    },
    {
      "type": "richtext",
      "id": "banner_description",
      "label": "Banner Description",
      "default": "<p>Discover our latest collection of premium products</p>"
    },
    {
      "type": "text",
      "id": "banner_button_text",
      "label": "Button Text",
      "default": "Shop Now"
    },
    {
      "type": "url",
      "id": "banner_button_link",
      "label": "Button Link"
    },
    {
      "type": "header",
      "content": "Product Settings"
    },
    {
      "type": "product",
      "id": "product_1",
      "label": "Product 1"
    },
    {
      "type": "product",
      "id": "product_2",
      "label": "Product 2"
    },
    {
      "type": "product",
      "id": "product_3",
      "label": "Product 3"
    },
    {
      "type": "select",
      "id": "quick_add",
      "options": [
        {
          "value": "none",
          "label": "None"
        },
        {
          "value": "standard",
          "label": "Standard"
        },
        {
          "value": "bulk",
          "label": "Bulk"
        }
      ],
      "default": "standard",
      "label": "Quick add"
    },
    {
      "type": "checkbox",
      "id": "show_short_description",
      "default": false,
      "label": "Show product short description"
    },
    {
      "type": "checkbox",
      "id": "show_price",
      "default": true,
      "label": "Show product price"
    }
  ],
  "presets": [
    {
      "name": "Banner with Products"
    }
  ]
}
{% endschema %}
